rules:
  - id: java.spring.log-injection
    languages:
      - java
    severity: ERROR
    metadata:
      cwe: CWE-117
      license: MIT
      shortDescription: Log an untrusted data
    message: Log an untrusted data
    patterns:
      - pattern-either:
        - patterns:
          - pattern: |
              String $FILENAME = $MULTIFILE.getOriginalFilename();
              ...
              $LOGGER.info(..., $FILENAME, ...);
          - pattern-inside: |
              @$ANNOTATION(...)
              $RETURNTYPE $METHOD(..., @RequestParam(...) MultipartFile $MULTIFILE, ...) {
                ...
              }
        - patterns:
          - pattern: |
              ServletInputStream $INPUT = $REQUEST.getInputStream();
              ...
              $LOGGER.info(..., $INPUT, ...);
          - pattern-inside: |
              @$ANNOTATION(...)
              $RETURNTYPE $METHOD(..., HttpServletRequest $REQUEST, ...) {
                ...
              }

      - metavariable-pattern:
          metavariable: $ANNOTATION
          pattern-either:
          - pattern: RequestMapping
          - pattern: DeleteMapping
          - pattern: GetMapping
          - pattern: PatchMapping
          - pattern: PostMapping
          - pattern: PutMapping
