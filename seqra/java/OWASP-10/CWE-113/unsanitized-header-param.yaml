rules:
  - id: unsanitized-header-param
    message: "Unsanitized value in header that depends on user input allows a response-splitting vulnerability"
    metadata:
      shortDescription: "Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')"
      cwe: CWE-113
    severity: ERROR
    patterns:
      - pattern-inside: |
          @GetMapping(...)
          public void $M(..., @RequestParam String $RAW_URL, HttpServletResponse $RESPONSE, ...) {
          ...
          }
      - pattern-either:
        - pattern: |
            File $FILE = new File($RAW_URL);
            String $FILE_NAME = $FILE.getName();
            $RESPONSE.setHeader("...", $FILE_NAME);
    languages:
      - java
